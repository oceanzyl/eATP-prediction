from modeller import *
from modeller.scripts import complete_pdb

log.verbose()    # request verbose output
env = Environ()
env.libs.topology.read(file='$(LIB)/top_heav.lib') # read topology
env.libs.parameters.read(file='$(LIB)/par.lib') # read parameters

# directories for input atom files
env.io.atom_files_directory = '/home/oceanzyl1807/Dorn1_prediction/Modeller/MODELLING_test-pipline/P2K1WT/1000-models_non-ion/p2k1.B9999'

# Read in the best model generated by model.py (you may need to change
# the name of the PDB file accordingly). complete_pdb ensures that the PDB
# file is complete and ready for energy evaluations.
mdl = complete_pdb(env, 'p2k1.B99990429.pdb', model_segment=('FIRST:A', 'LAST:A'))

# Get the DOPE energy profile for the entire model, smooth it with window
# averaging, and write the resulting profile to a file

prf = selection(mdl)
prf.assess_dope(output='ENERGY_PROFILE NO_REPORT', file='p2k1.B99990429.csv', normalize_profile=True, smoothing_window=15)

